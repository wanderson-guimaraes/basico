jQuery(document).ready(function(a){"use strict";function e(){window.console&&console.log.apply(console,arguments)}function t(){window.console&&console.warn.apply(console,arguments)}function i(a,e){a.find('.fw-wizard-step[data-stepId="'+e+'"]').removeClass("fw-current"),a.find('.fw-wizard-step-header[data-stepId="'+e+'"]').removeClass("fw-current"),a.find('.fw-progress-step[data-id="'+e+'"]').removeClass("fw-active"),a.find('.fwp-progress-bar .fwp-circle[data-id="'+e+'"]').removeClass("fwp-active")}function n(a,e){a.find('.fw-wizard-step[data-stepId="'+e+'"]').addClass("fw-current"),a.find('.fw-wizard-step-header[data-stepId="'+e+'"]').addClass("fw-current"),a.find('.fw-progress-step[data-id="'+e+'"]').addClass("fw-active")}function r(a){a.find(".fw-button-previous").hide()}function s(a){a.find(".fw-button-next").hide()}function f(a){a.find(".fw-button-previous").show()}function d(a){a.find(".fw-button-next").show()}function o(){var e=S(a(this)),t=O(e),s=parseInt(t,10),f=e.find('.fwp-progress-bar .fwp-circle[data-id="'+t+'"]'),o=e.find('.fwp-progress-bar .fwp-bar[data-id="'+(s-1)+'"]');e.find('.fw-progress-step[data-id="'+(s-1)+'"]').removeClass("fw-visited"),e.find('.fw-progress-step[data-id="'+t+'"]').removeClass("fw-visited"),f.removeClass("fwp-done"),5==s&&e.find(".fw-progress-bar").removeClass("fw-step-after-fifth"),f.find(".fwp-label").html(parseInt(t,10)+1),o.removeClass("fwp-active"),s>=2&&e.find('.fwp-progress-bar .fwp-bar[data-id="'+(s-2)+'"]').removeClass("fwp-done").addClass("fwp-active"),i(e,t--),e.find('.fwp-progress-bar .fwp-circle[data-id="'+t+'"]').find(".fwp-label").html(parseInt(t,10)+1),n(e,t),0===t&&r(e),d(e)}function l(){var e=S(a(this)),t=O(e),r=parseInt(t,10),d=e.find('.fwp-progress-bar .fwp-circle[data-id="'+t+'"]'),o=e.find('.fwp-progress-bar .fwp-bar[data-id="'+t+'"]');ea(t)&&(e.find('.fw-progress-step[data-id="'+t+'"]').addClass("fw-visited"),4==r&&e.find(".fw-progress-bar").addClass("fw-step-after-fifth"),d.removeClass("fwp-active").addClass("fwp-done"),d.find(".fwp-label").html("&#10003;"),o.addClass("fwp-active"),r>=1&&e.find('.fwp-progress-bar .fwp-bar[data-id="'+(r-1)+'"]').removeClass("fwp-active").addClass("fwp-done"),i(e,t++),n(e,t),t===q(e)-1&&s(e),f(e),a("html, body").animate({scrollTop:a("#multi-step-form").offset().top-100},500))}function c(a,e,t,i){u(a,t,e.find("h3").text(),e.find(".fw-text-input").val(),i)}function p(a,e,t,i){u(a,t,e.find("h3").text(),e.find(".fw-textarea").val(),i)}function u(a,e,t,i,n){var r={};i?(r[t]=i,Z(a,e).push(r)):"true"==n&&(r['<p class="fw-step-summary fw-summary-invalid">'+t]="</p>",Z(a,e).push(r))}function w(e,t,i,n){var r=t.find("h3").text(),s="";t.find(".fw-choice").each(function(e,t){a(t).find("input").is(":checked")&&(""!=s&&(s+=", "),s+=a(t).find("label").text())}),u(e,i,r,s,n)}function v(a,e,t,i){u(a,t,e.find("h3").text(),e.find("select").select2("data")[0].text,i)}function m(a,e,t,i){var n,r=e.find("label").text();e.find(".fw-checkbox").is(":checked")&&(n="yes"),e.hasClass("fw-block-invalid"),u(a,t,r,n,i)}function b(a,e,t,i){var n=ajax.i18n.registration,r=e.find(".msfp-registration-input[data-id=username]").val(),s=e.find(".msfp-registration-input[data-id=email]").val();u(a,t,n,r&&s?r+" ("+s+")":ajax.i18n.registrationFailed,i)}function h(a,e,t){var i=e.attr("data-required");switch(e.attr("data-type")){case"fw-email":case"fw-date":case"fw-text":c(a,e,t,i);break;case"fw-textarea":p(a,e,t,i);break;case"fw-radio":w(a,e,t,i);break;case"fw-select":v(a,e,t,i);break;case"fw-checkbox":m(a,e,t,i);break;case"fw-registration":b(a,e,t,i)}}function g(e,t,i){return e.find('.fw-wizard-step[data-stepId="'+t+'"]').find(".fw-step-part").each(function(e,t){var n=a(t).find(".fw-step-part-title").text().trim();a(t).find('.fw-step-block:not(.fw-step-block[style="display: none;"] > .fw-step-block):not(.msfp-block-conditional)').each(function(e,t){h(i,a(t),n)})}),""}function k(a){return a.replace(/^.*\\/,"")}function x(){var e=[];return a(".fw-step-block[data-type=fw-file]").each(function(a,t){e.push(y(t))}),e}function C(){var e={};return a(".msfp-registration-input").each(function(t,i){var n=a(i).attr("data-id");e[n]=a(i).val()}),e}function y(e){return k(a(e).find("input").val())}function j(a){var e,t=q(a),i={};for(e=0;e<t;e++)g(a,e,i);return i}function z(a){var e="",t=j(a);for(var i in t)e+='<div class="fw-step-summary-part">',e+=T(i),e+=I(t[i]),e+="</div>";return e}function T(a){return'<p class="fw-step-summary-title">'+a+"</p>"}function _(a){var e,t="";for(e in a)t='<p class="fw-step-summary">'+e+" â€” "+a[e]+"</p>";return t}function I(a){var e,t,i="";for(e=0,t=a.length;e<t;e++)i+=_(a[e]);return i}function F(e){var t=z(e),i=e.find(".fw-wizard-summary");i.empty(),i.append(t),a(".fw-toggle-summary").toggle(function(){a(".fw-wizard-summary").slideDown(),a(".fw-toggle-summary").text(ajax.i18n.hideSummary)},function(){a(".fw-wizard-summary").slideUp(),a(".fw-toggle-summary").text(ajax.i18n.showSummary)}),a(".fw-summary-invalid").length?i.prepend('<div class="fw-summary-alert">'+ga[2]+"</div>"):a(".fw-summary-alert").remove()}function S(a){return a.closest(".fw-wizard")}function q(a){return a.attr("data-stepCount")}function O(a){return a.find(".fw-current").attr("data-stepId")}function D(a){return a.closest(".fw-wizard-step").attr("data-stepId")}function P(a){return a.closest(".fw-step-part").attr("data-partId")}function A(a){return a.closest(".fw-step-block").attr("data-blockId")}function E(a){var t=[].slice.call(arguments,1),i=0,n=t.length;if(e("args",t),"0"===t[0])throw new TypeError;for(;i<n;i++)a=R(a,t[i]);return a}function R(a,e){return a[e]||(a[e]={}),a[e]}function W(a,e){var t=D(e),i=P(e),n=A(e);return E(ha,a.attr("id"),t,i,n)}function Z(a,e){return a[e]||(a[e]=[]),a[e]}function Q(){var e=a(this),t=S(e),i=e.prop("checked"),n=W(t,e),r=e.attr("data-id");i?n[r]="checked":delete n[r],F(t)}function U(t,i){var n,r,s=t.attr("id"),f=i.attr("name"),d=A(i),o=a('.fw-radio[name="'+f+'"]'),l=!1;e("radios",o),o.each(function(e,t){d!==A(a(t))&&(l=!0)}),n=D(i),r=P(i),l?delete E(ha,s,n)[r]:delete E(ha,s,n,r)[d],F(t)}function Y(){var e=a(this),t=e.attr("data-id"),i=e.closest(".fw-conditional");i.find(".fw-conditional-then").removeClass("fw-selected"),i.find('.fw-conditional-then[data-id="'+t+'"]').addClass("fw-selected")}function $(){var e=a(this),t=S(e);U(t,e),W(t,e)[e.attr("data-id")]="checked",F(t)}function B(){var t=a(this),i=S(t),n=t.val();e(n);var r=t.attr("data-id");W(i,t)[r]=n,t.parents(".fw-step-block").removeClass("fw-block-invalid"),t.parents(".fw-step-block").find(".fw-block-invalid-alert").remove(),F(i)}function G(e){var t=!1;return e.children(".fw-choice").find("input").each(function(e,i){a(i).is(":checked")&&(t=!0)}),t||e.addClass("fw-block-invalid"),t}function H(a){var e=!1;return a.find("select").val()&&(e=!0),e}function J(a){var e=a.find(".fw-text-input").val();return!(!e||!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e))||(a.addClass("fw-block-invalid"),!1)}function K(a){return!!a.find(".fw-file-upload-input").val()||(a.addClass("fw-block-invalid"),!1)}function L(a){return!!a.find(".fw-text-input").val()||(a.addClass("fw-block-invalid"),!1)}function M(a){return!!a.find(".fw-text-input").val()||(a.addClass("fw-block-invalid"),!1)}function N(a){return!!a.find(".fw-textarea").val()||(a.addClass("fw-block-invalid"),!1)}function V(a){return!!a.find(".fw-checkbox").prop("checked")||(a.addClass("fw-block-invalid"),!1)}function X(a){var e=a.find("[data-id=name]").val(),t=a.find("[data-id=email]").val(),i=!0;return e&&t||(a.has("input")?i=!0:(a.addClass("fw-block-invalid"),i=!1)),i}function aa(a){var e=!0,t=a.find("[data-id=username]"),i=a.find("[data-id=email]"),n=t.hasClass("msfp-reg-username-valid"),r=i.hasClass("msfp-reg-email-valid");return n||(a.addClass("fw-block-invalid"),t.removeClass("msfp-reg-username-valid"),t.addClass("msfp-registration-invalid"),e=!1),r||(a.addClass("fw-block-invalid"),i.removeClass("msfp-reg-email-valid"),i.addClass("msfp-registration-invalid"),e=!1),e}function ea(e){var t=!0,i=!0,n=!0;return a('.fw-wizard-step[data-stepid="'+e+'"] .fw-step-block[data-required="true"]:visible').each(function(e,r){var s=a(r);switch(s.attr("data-type")){case"fw-radio":t=G(s);break;case"fw-select":t=H(s);break;case"fw-textarea":t=N(s);break;case"fw-text":t=M(s);break;case"fw-email":t=J(s),i=t;break;case"fw-file":t=K(s);break;case"fw-date":t=L(s);break;case"fw-checkbox":t=V(s);break;case"fw-submit":t=X(s);break;case"fw-registration":t=aa(s)}t||(n=!1)}),a('.fw-wizard-step[data-stepid="'+e+'"] .fw-step-block[data-type="fw-email"]').each(function(e,i){var r=a(i);""!=r.find(".fw-text-input").val()&&((t=J(r))||(n=!1))}),n||(a(".fw-block-invalid").each(function(e,t){a(t).find(".fw-block-invalid-alert").length<1&&("fw-registration"==a(t).attr("data-type")?a(t).append('<div class="fw-block-invalid-alert">'+ajax.i18n.errors.checkFields+"</div>"):a(t).append('<div class="fw-block-invalid-alert">'+ga[1]+"</div>"))}),ra(ga[0],!1)),n}function ta(e){var i=e.closest(".fw-step-block"),n={action:"msfp_pre_validate_reg_email",email:e.val(),nonce:ajax.nonce};a.ajax({type:"POST",url:ajax.ajaxurl,data:n,dataType:"json",success:function(a){a.success?(e.removeClass("msfp-registration-invalid"),e.addClass("msfp-reg-email-valid"),e.next().next().remove(".fw-block-invalid-alert"),i.find(".msfp-reg-username-valid").length>0&&i.removeClass("fw-block-invalid")):(i.addClass("fw-block-invalid"),e.addClass("msfp-registration-invalid"),e.removeClass("msfp-reg-email-valid"),e.next().next().hasClass("fw-block-invalid-alert")||e.next().after('<div class="fw-block-invalid-alert">'+a.error+"</div>"))},fail:function(a){valid=!1,t("response",a),t("responseText",a.responseText)}})}function ia(e){var i=e.closest(".fw-step-block"),n={action:"msfp_pre_validate_reg_username",username:e.val(),nonce:ajax.nonce};a.ajax({type:"POST",url:ajax.ajaxurl,data:n,dataType:"json",success:function(a){a.success?(e.removeClass("msfp-registration-invalid"),e.addClass("msfp-reg-username-valid"),e.next().next().remove(".fw-block-invalid-alert"),i.find(".msfp-reg-email-valid").length>0&&i.removeClass("fw-block-invalid")):(i.addClass("fw-block-invalid"),e.removeClass("msfp-reg-username-valid"),e.addClass("msfp-registration-invalid"),e.next().next().hasClass("fw-block-invalid-alert")||e.next().after('<div class="fw-block-invalid-alert">'+a.error+"</div>"))},fail:function(a){valid=!1,t("response",a),t("responseText",a.responseText)}})}function na(e){var t=!0;return a(".fw-wizard-step").each(function(e,i){a(i);ea(e)||(t=!1)}),t}function ra(e,t){a(".fw-alert-user").empty().removeClass("fw-alert-user-fail fw-alert-user-success"),t?a(".fw-alert-user").addClass("fw-alert-user-success").append('<i class="fa fa-check-circle" aria-hidden="true"></i>'):a(".fw-alert-user").addClass("fw-alert-user-fail").append('<i class="fa fa-times-circle" aria-hidden="true"></i>'),a(".fw-alert-user").append(e).fadeIn().delay(2e3).fadeOut()}function sa(e){var t,i,n,r=[],s=a(this).closest(".fw-wizard");a(".fw-block-invalid").each(function(e,t){a(t).removeClass("fw-block-invalid")}),na(s)&&(a(".fw-spinner").show(),t=j(s),r=x(),i=s.find('[data-id="email"]').first().val(),s.find("[data-type=fw-registration]")&&(n=C()),fa(t,i,r,n))}function fa(e,i,n,r){var s=a("#multi-step-form").attr("data-wizardid");a(".fw-btn-submit").html('<i class="fa fa-spinner"></i> '+ajax.i18n.sending),a.post(ajax.ajaxurl,{action:"fw_send_email",id:s,fw_data:e,email:i,reg:r,attachments:n,nonce:ajax.nonce},function(e){var t=a(".fw-container").attr("data-redirect");t?(window.onbeforeunload=null,window.location.href=t):(a(".fw-btn-submit").addClass("fw-submit-success").html('<i class="fa fa-check-circle"></i> '+ajax.i18n.submitSuccess),a(".fw-btn-submit").unbind("click"))}).fail(function(e){a(".fw-btn-submit").addClass("fw-submit-fail").html('<i class="fa fa-times-circle"></i> '+ajax.i18n.submitError),t("response",e),t("responseText",e.responseText)})}function da(e,i){var n=a("#multi-step-form").attr("data-wizardid"),r=a(e.target).prop("files")[0],s=new FormData;s.append("action","fw_upload_file"),s.append("file",r),s.append("id",n),s.append("nonce",ajax.nonce),i.find("i").removeClass("fa-upload fa-times-circle fa-check-circle").addClass("fa-spinner"),i.find("span").text(ajax.i18n.uploadingFile);var f=a(e.target).parent().parent();a.ajax({type:"POST",url:ajax.ajaxurl,data:s,contentType:!1,processData:!1,dataType:"json",success:function(a){wa(),a.success?(f.attr("data-uploaded","true"),i.find("i").removeClass("fa-times-circle fa-spinner").addClass(" fa-check-circle"),i.find("span").html(r.name)):(i.find("i").removeClass("fa-spinner fa-check-circle").addClass("fa-times-circle"),i.find("span").html(a.error),t(a.error))},fail:function(a){}})}function oa(e){a.post(ajax.ajaxurl,{action:"fw_delete_files",filenames:e,nonce:ajax.nonce},function(e){e&&a("[data-type=fw-file]").each(function(e,t){var i=a(t).find("input");i.replaceWith(i.val("").clone(!0)),a(t).find("label > i").removeClass("fa-check-circle").addClass("fa-upload"),a(t).find("label > span").text(ajax.i18n.chooseFile),a(t).attr("data-uploaded","false")})}).fail(function(a){t("response",a),t("responseText",a.responseText)})}function la(){var e=a(".msfp-registration-input[data-id=email]"),t=a(".msfp-registration-input[data-id=username]");e.closest(".fw-step-block");e.on("input",function(a){ta(e)}),t.on("input",function(a){ia(t)})}function ca(){a(".fw-file-upload-input").each(function(){var e=a(this),t=e.next("label"),i=t.html(),n=e.parent().parent();e.on("change",function(a){var e="";a.target.value&&(e=a.target.value.split("\\").pop()),e?da(a,t):t.html(i)}),e.on("click",function(a){if(a.target.value){var e=[];e.push(y(n)),oa(e)}}),e.on("focus",function(){e.addClass("has-focus")}).on("blur",function(){e.removeClass("has-focus")})})}function pa(){a("select").each(function(e,t){a(t).data("search")?a("select").select2({allowClear:!0,placeholder:""}):a(t).select2({minimumResultsForSearch:1/0,allowClear:!0,placeholder:""})})}function ua(){var e=a(".fw-progress-bar").attr("data-activecolor"),t=a(".fw-progress-bar").attr("data-donecolor"),i=a(".fw-progress-bar").attr("data-nextcolor"),n=a(".fw-progress-bar").attr("data-buttoncolor");a("head").append('<style id="fw-colors"></style>'),e&&a("head").append("<style>.fw-active .progress, ul.fw-progress-bar li.fw-active:before{background:"+e+"!important;} [data-type=fw-checkbox] input[type=checkbox]:checked+label:before, ul.fw-progress-bar li.fw-active .fw-txt-ellipsis { color: "+e+" !important; } .fw-step-part { border-color: "+e+" !important; }</style>"),t&&a("head").append("<style>ul.fw-progress-bar .fw-active:last-child:before, .fw-progress-step.fw-visited:before{ background:"+t+" !important; } .fw-progress-step.fw-visited, ul.fw-progress-bar .fw-active:last-child .fw-txt-ellipsis, .fw-progress-step.fw-visited .fw-txt-ellipsis { color:"+t+" !important;} ul.fw-progress-bar li.fw-visited:after, .fw-progress-step.fw-visited .fw-circle, .fw-progress-step.fw-visited .fw-circle-1, .fw-progress-step.fw-visited .fw-circle-2{ background-color:"+t+" !important;}</style>"),i&&a("head").append("<style>ul.fw-progress-bar li:before{background:"+i+" !important;} .fw-progress-bar li.fw-active:after, li.fw-progress-step::after, .fw-circle, .fw-circle-1, .fw-circle-2{ background-color:"+i+" !important;} .fw-txt-ellipsis { color: "+i+" !important; } </style>"),n&&a("head").append("<style>.fw-button-previous, .fw-button-next, .fw-button-fileupload { background: "+n+" !important; }</style>")}function wa(){a("#multi-step-form").length&&(window.onbeforeunload=function(){return oa(x()),"Your uploaded files were deleted from the server for security reasons."})}function va(){var e=a(".fw-datepicker-here").attr("data-dateformat");a(".fw-datepicker-here").datepicker({dateFormat:e})}function ma(){a(".fw-checkbox").change(Q),a(".fw-radio").change($),a(".fw-radio-conditional").change(Y),a(".fw-text-input").on("change input",B),a(".fw-textarea").on("change input",B),a(".fw-checkbox, .fw-radio").on("change",function(){a(this).parents(".fw-step-block").removeClass("fw-block-invalid"),a(this).parents(".fw-step-block").find(".fw-block-invalid-alert").remove()}),a(".msfp-registration-input").change(B)}function ba(){var e=a(".fw-wizard");e.each(function(e,t){n(a(t),0)});var t=q(e),i=e.parent().outerWidth();(t>=5&&i>=769||i>=500)&&e.addClass("fw-large-container"),a('.fw-progress-step[data-id="0"]').addClass("fw-active"),a(".fw-button-previous").hide(),a(".fw-button-previous").click(o),a(".fw-button-next").click(l),"off"==a(".fw-wizard-summary").attr("data-showsummary")&&a(".fw-toggle-summary").remove(),ma(),pa(),ca(),va(),a(".fw-btn-submit").click(sa),ua(),la(),F(a(".fw-wizard"))}var ha={},ga=[ajax.i18n.errors.requiredFields,ajax.i18n.errors.requiredField,ajax.i18n.errors.someRequired+"<br>"+ajax.i18n.errors.checkFields];a(document).ready(function(e){a("#multi-step-form").length&&ba()})}),function(){"use strict"}();